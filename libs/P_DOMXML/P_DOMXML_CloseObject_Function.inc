<?
/*********************************************************************/
/*      V001 ： 新規  2004.05.01  桝形                               */
/*      V002 ： 修正  2004.07.01  桝形                               */
/*      V003 ： 修正  2004.12.01  桝形                               */
/*      V004 ： 修正  2006.01.06  桝形                               */
/*********************************************************************/

/*********************************************************************/
/*    関数名 ： P_DOMXML_CloseObject                                 */
/*-------------------------------------------------------------------*/
/*      機能 ： XMLドキュメントObjectを終了                          */
/*-------------------------------------------------------------------*/
/*      引数 ： $XML (i)    XMLファイル名                            */
/*-------------------------------------------------------------------*/
/*    戻り値 ： なし                                                 */
/*-------------------------------------------------------------------*/
/*      警告 ： グローバル領域変数を占有しているので、下記の変数     */
/*           ： に対して参照以外の利用は避けて下さい。               */
/*           ：                                                      */
/*           ： $P_DOMXML_Management_Array                           */
/*           ： $P_DOMXML_Management_XPath_Array                     */
/*           ： $P_DOMXML_ResultCache_Array                  *//*P003*/
/*-------------------------------------------------------------------*/
/* Copyright ： DNP DigitalCom CO.,LTD.                              */
/*      P001 ： 新規  2004.05.01  桝形                               */
/*      P002 ： 修正  2004.07.01  桝形                               */
/*      P003 ： 修正  2004.12.01  桝形                               */
/*      P004 ： 修正  2006.01.06  桝形                               */
/*********************************************************************/
function P_DOMXML_CloseObject( $XML )
{
 global $P_DOMXML_Management_Array;
 global $P_DOMXML_Management_XPath_Array; /* P002 : Add!! */
 global $P_DOMXML_ResultCache_Array; /* P003 : Add!! */

 if( is_array( $XML ) == TRUE ){ $XML = $XML["XML"]; } /* P003 : Add!! */

 if( @is_file( $XML ) == TRUE ){ $XML = realpath( $XML ); }

/* P003 : Add Start!! ************************************************/

 $DOM =& $P_DOMXML_Management_Array[$XML];

/* P004 : Change Start!! *********************************************/

/**********************************************************************

 $DOM->free( );

**********************************************************************/

 if( @is_object( $DOM ) == TRUE ){ $DOM->free( );  }

/*********************************************** P004 : Change End!! */

 if( is_array( $P_DOMXML_ResultCache_Array ) == TRUE )
   {
    foreach( $P_DOMXML_ResultCache_Array as $Key => $Value )
    {
     if( mb_strpos( $Key, $XML ) !== FALSE )
       { $P_DOMXML_ResultCache_Array[$Key] = ""; }
    }
   }

/************************************************** P003 : Add End!! */

 $P_DOMXML_Management_Array[$XML] = "";
 $P_DOMXML_Management_XPath_Array[$XML] = ""; /* P002 : Add!! */
}

?>
