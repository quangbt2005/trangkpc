<?
/*********************************************************************/
/*      V001 ： 新規  2004.01.01  桝形                               */
/*********************************************************************/

/*********************************************************************/
/*    関数名 ： P_Del_Cr                                             */
/*-------------------------------------------------------------------*/
/*      機能 ： 改行削除( "0x0d", "0x0a", "0x0d,0x0a"を改行とする )  */
/*-------------------------------------------------------------------*/
/*      引数 ： $In (i)    処理対象文字列                            */
/*-------------------------------------------------------------------*/
/*    戻り値 ： 処理後文字列                                         */
/*-------------------------------------------------------------------*/
/* Copyright ： DNP DigitalCom CO.,LTD.                              */
/*      P001 ： 新規  2004.01.01  神田                               */
/*********************************************************************/
function P_Del_Cr( $In )
{
 $Len = strlen( $In ); $XX = 0;

 if( $Len >= 2 )
   {
    if( ord( $In[$Len-2] ) == 13 && ord( $In[$Len-1] ) == 10 )
      { $XX = 2; }
      else
      if( ord( $In[$Len-1] ) == 13 || ord( $In[$Len-1] ) == 10 )
        { $XX = 1; }
   }
   else
   {
    if( strlen( $In ) == 1 &&
      ( ord( $In[$Len-1] ) == 13 || ord( $In[$Len-1] ) == 10 ) )
      { $XX = 1; }
   }

 return substr( $In, 0, ( $Len - $XX ) );
}

?>
